# 数据库基础命令
- 增
```
insert into <表名> [( <字段名1>[,..<字段名n > ])] values ( 值1 )[, ( 值n )];
```
- 删
```
delete from 表名 where 表达式;
```
- 改
```
update 表名 set 字段 = 新值,… where 条件;
```
- 查
```
select <字段1，字段2，...> from < 表名 > where < 表达式 >
# 使用limit限制条数
select * from myclass limit n;
# 使用orderby 根据字段排序
select * from myclass order by id limit 2;
```
- 其它
```
1. 表中增加字段:alter table 表名 add 字段 类型 其他
2. 导出数据库：mysqldump -u 用户名 -p 数据库名 > 导出的文件名
3. union语句相关：
UNION 语句：用于将不同表中相同列中查询的数据展示出来；（不包括重复数据）
UNION ALL 语句：用于将不同表中相同列中查询的数据展示出来；（包括重复数据）
```
1. 索引创建  
```
1. ALTER TABLE table_name ADD INDEX index_name (column_list);
2. CREATE TABLE user_index2 (
	id INT auto_increment PRIMARY KEY,
	first_name VARCHAR (16),
	last_name VARCHAR (16),
	id_card VARCHAR (18),
	information text,
	KEY name (first_name, last_name),
	FULLTEXT KEY (information),
	UNIQUE KEY (id_card)
);
3. CREATE INDEX index_name ON table_name (column_list);
```
2. 索引删除
```
alter table 表名 drop KEY 索引名
```                                                 

---
**数据库三大范式是什么?**  
- 第一范式：每个列都不可以再拆分。  
- 第二范式：在第一范式的基础上，非主键列完全依赖于主键，而不能是依赖于主键的一部分。  
- 第三范式：在第二范式的基础上，非主键列只依赖于主键，不依赖于其他非主键。
___
__InnoDB引擎的4大特性__  
- 插入缓冲（insert buffer)  
- 二次写(double write)  
- 自适应哈希索引(ahi)  
- 预读(read ahead)  
___
# 索引
**什么是索引？**  
- 索引是一种特殊的文件(InnoDB数据表上的索引是表空间的一个组成部分)，它们包含着对数据表里所有记录的引用指针。索引是一种数据结构。数据库索引，是数据库管理系统中一个排序的数据结构，以协助快速查询、更新数据库表中数据。索引的实现通常使用B树及其变种B+树。更通俗的说，索引就相当于目录。为了方便查找书中的内容，通过对内容建立索引形成目录。索引是一个文件，它是要占据物理空间的。

**索引有哪些优缺点？**  
- **索引的优点**  
  可以大大加快数据的检索速度，这也是创建索引的最主要的原因。通过使用索引，可以在查询的过程中，使用优化隐藏器，提高系统的性能。
- **索引的缺点**  
  时间方面：创建索引和维护索引要耗费时间，具体地，当对表中的数据进行增加、删除和修改的时候，索引也要动态的维护，会降低增/改/删的执行效率；空间方面：索引需要占物理空间。

**索引使用场景**
- **查询**
- **join语句**
- **排序（orderby）**
---

**数据库为什么使用B+树而不是B树?**  
- B树只适合随机检索，而B+树同时支持随机检索和顺序检索；
- B+树空间利用率更高，可减少I/O次数，磁盘读写代价更低
- B+树的查询效率更加稳定。。
- B+树的叶子节点使用指针顺序连接在一起，只要遍历叶子节点就可以实现整棵树的遍历。
- 增删文件（节点）时，效率更高。因为B+树的叶子节点包含所有关键字，并以有序的链表结构存储，这样可很好提高增删效率。
---
# 事务
- **什么是数据库事务?**
   - 事务是一个不可分割的数据库操作序列，也是数据库并发控制的基本单位，其执行的结果必须使数据库从一种一致性状态变到另一种一致性状态。事务是逻辑上的一组操作，要么都执行，要么都不执行。
- **事务的四大原则**  
   - 原子性：事务是最小的执行单位，不允许分割。事务的原子性确保动作要么全部完成，要么完全不起作用；
   - 一致性：执行事务前后，数据保持一致，多个事务对同一个数据读取的结果是相同的；
   - 持久性：一个事务被提交之后。它对数据库中数据的改变是持久的，即使数据库发生故障也不应该对其有任何影响
   - 隔离性：并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的；
- **事务命令**
   - MYSQL 事务处理主要有两种方法：
      - 1、用 BEGIN, ROLLBACK, COMMIT来实现
         - BEGIN 开始一个事务
         - ROLLBACK 事务回滚
         - COMMIT 事务确认
      - 2、直接用 SET 来改变 MySQL 的自动提交模式:
         - SET AUTOCOMMIT=0 禁止自动提交
         - SET AUTOCOMMIT=1 开启自动提交
- **事务隔离级别**
   - 序列化: 以系列的形式对事务进行提交.只有当事务提交完成,用户才可以看到数据库的变化 (无幻读,脏读,不可重复读)
   - 可重读: 相较与序列化,其安全性较低,但同样只有当事务提交完成,用户才可以看到数据库的变化. (无脏读,不可重复读,有幻读)
   - 提交后读: 用户可以看到其他事务提交的记录. (无脏读,有不可重复读,有幻读)
   - 未提交读: 用户可以看到其他未提交事务的记录.(有幻读,脏读,不可重复读)
![blockchain](https://images2015.cnblogs.com/blog/779738/201701/779738-20170109104825775-501316107.png)

~~#- **保障事务一致性方式**~~
   ~~- MVCC:不用加任何锁，通过一定机制生成一个数据请求时间点的一致性数据快照（Snapshot），并用这个快照来提供一定级别（语句级或事务级）的一致性读取。从用户的角度，好像是数据库可以提供同一数据的多个版本~~  

---   
# 数据库优化
   - 一般的查看慢查询日志
   - 使用explain / describe分析查询结构,其中比较重要的部分属性
      - possible_key->索引
      - key 实际使用的键
   - 查询优化:    
      - 索引查询优化:
         - 使用like关键字优化(%不要置于首个字符)
         - 多列索引建立.严格索引的属性置于靠前位置.
         - OR关键字中,查询字段最好均为索引.
      - 优化数据库结构
         - 分解字段过多的表.
         - 增加中间表->将频繁查询的多个表中的字段建立一个中间表
   - 插入优化
      - 禁用一致性检查,插入完成后开启
      - 禁用索引,插入完成后开启
      - 优化insert语句. 多条记录优化成为一次插入.
   - 经常使用高速缓存查询.
   - 优化多表查询
      - 
   - tips:
      - 表中存在text,blob字段的数据类型,更新和删除后,分配的空间不会自动收回.

---
# 数据库锁
- ****


   


