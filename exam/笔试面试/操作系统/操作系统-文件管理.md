<!-- TOC -->

- [文件管理](#文件管理)
    - [文件概念](#文件概念)
    - [目录结构](#目录结构)
    - [文件共享](#文件共享)
    - [文件保护](#文件保护)
    - [文件系统实现](#文件系统实现)

<!-- /TOC -->
# 文件管理

## 文件概念
   - 文件的定义: 计算机硬盘为载体的存储在计算机上的信息集合.u用户输入输出中,以文件作为基本单位.
   - 文件系统:  访问文件,修改文件,保存文件等实现文件的维护操作.
   - 文件的结构: 
        1. 数据项: 文件系统中最低级的数据组织形式.
            - 基本数据项:用于描述对象某个属性的一个值.(原子数据)
            - 组合数据项: 多个基本数据项组成.
        2. 记录: 一组相关的数据项的集合.用于描述一个对象在某个方面的属性.
        3. 文件: 创建者所定义的一组相关信息的集合.
   - 文件的属性:
        1. 名称:文件名唯一
        2. 标识符:表示文件系统内文件的唯一标签
        3. 类型:被不同类型的文件系统使用
        4. 位置:指向设备和设备上文件的指针.
        5. 大小:文件当前大小,也可包含文件允许的最大值 
        6. 保护:对文件进行保护的访问控制信息.
        7. 时间`日期和用户标识 
   - 文件的操作:
        1. 创建文件
        2. 写入文件
        3. 文件重定位(文件寻址)
        4. 读入文件
        5. 删除文件
        6. 文件截断
   - 文件的打开与关闭
        1. 打开:使用系统调用: open ,指明文件的属性,从外存复制到内存.
           - 打开的文件包括一下信息:文件指针,文件打开计数.文件磁盘位置,文件访问权限.
        2. 关闭:没执行一次操作,打开计数--.
   - 文件逻辑结构
        1. 无结构文件(流式文件)
           - 以字节byte作为单位.
        2. 结构文件(记录式文件)   
           1. 顺序文件:文件中记录是顺序排列.(链式存储/顺序存储)
           2. 索引文件:对于定长文件,可根据下标和定长确定记录位置.对于不定长文件,则需要顺序遍历.
           3. 索引顺序文件:顺序文件中的记录分组,建立索引.
           4. 直接文件(散列文件):给定记录的键值,直接获取记录位置

## 目录结构
   - 文件控制块和索引节点
      - 文件控制块(FCB):用来存储控制文件相关信息的数据结构(必须连续存放)
      - 文件目录:FCB的有序集合,一个FCB就是一个文件目录项.包含 :      
         1. 基本信息:文件名,物理地址,物理结构,逻辑结构等.
         2. 存放控制信息:包括文件相关权限.
         3. 使用信息:文件建立时间,修改时间等. 
      - 索引节点:类似与文件目录.不过将文件名与其他数据分开存放.   
         1. 同时包括磁盘索引链接,内存索引链接. 

   - 目录结构
      1. 目录操作:
         - 搜索文件,删除文件,创建文件.显示目录,修改目录.
      2. 目录分类
         - 一级目录:仅存在一个目录,所有的文件与FCB一一对应.
         - 两级目录:主文件目录(存放用户标识以及对应的文件存放),用户文件目录.
         - 多级目录(树形结构):从根节点出发,通过文件名的目录层级,表示数据.
         - 无环图目录:便于文件共享.

## 文件共享
   - 基于索引节点的共享方式(硬链接):多个文件执行相同的索引节点
   - 利用符号链实现文件共享(软链接):将共享的文件路径写入目录中.

## 文件保护
   - 访问类型:读,写,执行,添加,删除,列表清单.
   - 访问控制:
      - 增加访问控制列表
         - 精简的访问控制列表:拥有者,组,其他
      - 口令和密码
         - 文件创建时候,给定一个口令.其他用户访问必须提供口令.
         - 密码指用户对文件加密,文件被访问的时候需要使用密钥.

## 文件系统实现
   - 文件系统的层级结构
      1. 用户调用接口:文件以及目录的相关操作接口
      2. 文件目录系统:管理文件目录
      3. 存取控制验证:验证用户操作权限
      4. 逻辑文件系统与缓冲区:根据用户读写逻辑,转为对应记录为相对块号
      5. 物理文件系统:块号转化为物理地址.
      6. 辅助分配模块(外存管理)
      7. 设备管理程序模块:设备外部相关管理.
   - 目录实现
      1. 线性列表: 线性查找
      2. 哈希表: 散列查找
   - 文件实现
      - 文件分配方式
         1. 连续分配:物理空间为连续的块
         2. 链接分配:离散分配的方式,减小了外部碎片.
            - 隐式分配:每个块后绑定下一个块位置
            - 显示分配:使用文件分配表,存储链接文件的指针.
         3. 索引分配:构建索引表(所有文件的盘块号)每一个索引块中包含下一个位置的块物理地址
      - 文件存储空间管理
         1. 文件卷:一般为(目录区:文件区(对于大文件,可以跨越多个卷))
         2. 文件存储空间管理:
            - 空闲表:将所有的闲置块写在一个表中
            - 空闲链表法:所有的空闲块拉成一条链
            - ***位视图法***:使用二进制的一位标识一个磁盘中的某个块的使用情况
            - 成组链接法:将所有的扇区,传链.结合空闲表和空闲链表法.
            - 超级块:保存位向量/目录区(文件区)/文件划分信息 等信息都包含其中.
   - 磁盘组织与管理
      1. 磁盘构成
      2. 磁盘调度算法
         - 先来先服务
         - 最短寻找时间优先:可能会产生饥饿
         - 扫描算法(SCAN/电梯算法):选定一个方向直到低部,然后在想另一个方向,这样不断循环往复.
         - 循环扫描(C-SCAN):确定一个方向后,不断按照这个方向扫描.不会反方向扫描.
      3. 磁盘管理
         - 磁盘初始化:1:将磁盘分区(C/D)   2:分区逻辑格式化(创建文件系统)
         - 引导块:ROM保存很小的自举程序,完整程序存放在启动磁盘上
         - 坏块:一般的,维护一个坏块链表.
         